import{b as g,d as v,q as c,a5 as a,am as E,x as P,aT as u,y as l,a2 as L,S as y,a6 as R,as as j}from"./index-8c4ccd06.js";var b=j("<div id=swf-container>");const C=()=>{const m=g(),{replace:i}=v(),[w,n]=c(!0),[p,o]=c(!1);let r=a.objs.filter(e=>e.name.toLowerCase().endsWith(".swf"));r.length===0&&(r=[a.obj]);const d=e=>{const t=r.findIndex(s=>s.name===a.obj.name);e.key==="ArrowLeft"&&t>0?i(r[t-1].name):e.key==="ArrowRight"&&t<r.length-1&&i(r[t+1].name)};E(()=>{window.addEventListener("keydown",d),h()}),P(()=>{window.removeEventListener("keydown",d);const e=document.getElementById("ruffle-player");e==null||e.remove();const t=document.getElementById("ruffle-script");t==null||t.remove()});const h=()=>{n(!0),o(!1);const e=document.getElementById("ruffle-player");if(e==null||e.remove(),window.RufflePlayer){f();return}const t=document.createElement("script");t.src="/static/ruffle/ruffle.js",t.async=!0,t.id="ruffle-script",t.onload=()=>{f()},t.onerror=()=>{o(!0),n(!1),console.error("无法加载Ruffle播放器")},document.head.appendChild(t)},f=()=>{try{const t=window.RufflePlayer.newest().createPlayer();t.id="ruffle-player",t.style.width="100%",t.style.height="100%";const s=document.getElementById("swf-container");s&&(s.innerHTML="",s.appendChild(t),t.addEventListener("loaded",()=>{n(!1)}),t.addEventListener("error",()=>{o(!0),n(!1)}),t.load(a.raw_url))}catch(e){console.error("Ruffle初始化失败:",e),o(!0),n(!1)}};return(()=>{var e=b();return e.style.setProperty("position","relative"),e.style.setProperty("width","100%"),e.style.setProperty("height","75vh"),e.style.setProperty("display","flex"),e.style.setProperty("justify-content","center"),e.style.setProperty("align-items","center"),u(e,l(y,{get when(){return w()},get children(){return l(L,{})}}),null),u(e,l(y,{get when(){return p()},get children(){return l(R,{get msg(){return m("preview.failed_load_swf")},h:"75vh"})}}),null),e})()};export{C as default};
